<div class="container-fluid">
    <div class="row g-0 min-vh-100">
        <main class="col-12 col-md-9 col-lg-12 px-3 px-lg-4 py-4 bg-light">
            <div *ngIf="data" class="mb-4 client-wrap">
                    <div class="details">
                        <div class="details-inner">
                            <div class="card-body">
                                <h4>Servicios</h4>

                                <div class="row g-3">
                                    <div class="col-12 col-md-6 col-lg-4">
                                        <div class="card service-card h-100 border-0 rounded-4 bg-soft shadow-sm">
                                            <div class="card-body d-flex gap-3 align-items-center">

                                                <div class="w-100">
                                                    <div class="d-flex justify-content-between align-items-start">
                                                        <div>
                                                            <div class="text-muted small">Internet</div>
                                                            <div class="kpi">{{ (data.cliente?.planInternet || 0) }}
                                                                Mbps </div>
                                                        </div>

                                                        <div class="text-end">
                                                            <div class="service-meta">Precio</div>
                                                            <div class="price">
                                                                {{ (data.servicios?.internet?.precio || 0) |
                                                                currency:'MXN':'symbol':'1.0-0' }}/mes
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                    <div class="col-12 col-md-6 col-lg-4">
                                        <div class="card service-card h-100 border-0 rounded-4 bg-soft shadow-sm">
                                            <div class="card-body d-flex gap-3 align-items-center">

                                                <div class="w-100">
                                                    <div class="d-flex justify-content-between align-items-start">
                                                        <div>
                                                            <div class="text-muted small">Cámaras</div>
                                                            <div class="kpi fs-5">{{
                                                                data.servicios?.camaras?.canServicios
                                                                || 0
                                                                }} servicio(s)</div>
                                                        </div>
                                                        <div class="text-end">
                                                            <div class="service-meta">Costo</div>
                                                            <div class="price">
                                                                {{ (data.servicios?.camaras?.precio || 0) |
                                                                currency:'MXN':'symbol':'1.0-0' }}/mes
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="mt-2 small text-muted">Precio por camara</div>
                                                </div>

                                            </div>
                                        </div>
                                    </div>


                                    <div class="col-12 col-md-6 col-lg-4">
                                        <div class="card service-card h-100 border-0 rounded-4 bg-soft shadow-sm">
                                            <div class="card-body d-flex gap-3 align-items-center">

                                                <div class="w-100">
                                                    <div class="d-flex justify-content-between align-items-start">
                                                        <div>
                                                            <div class="text-muted small">Telefonía</div>
                                                            <div class="kpi fs-5">{{ data.servicios?.telefonia?.lineas
                                                                || 0
                                                                }}
                                                                línea(s)</div>
                                                        </div>

                                                        <div class="text-end">
                                                            <div class="service-meta">Tarifa</div>
                                                            <div class="price">
                                                                {{ (data.servicios?.telefonia?.precio || 0) |
                                                                currency:'MXN':'symbol':'1.0-0' }}/mes
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="mt-2 small text-muted">Precio por linea telefonica</div>
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <br>
                            <hr>

                            <div class="row-3">
                                <h4>Estado de cuenta</h4>
                                <section class="summary-card">
                                    <div class="summary-left">
                                        <div class="label">Velocidad</div>
                                        <div class="value">{{ data.cliente?.planInternet || 0 }} <span
                                                class="unit">Mbps</span></div>
                                        <div class="sub">Plan contratado</div>
                                    </div>

                                    <div class="summary-center">
                                        <div class="label">Total mensual</div>
                                        <div class="value">{{ calcularTotalMensual(data.servicios) |
                                            currency:'MXN':'symbol':'1.0-0' }}</div>
                                        <div class="sub muted">Incluye servicios activos</div>
                                    </div>

                                    <div class="summary-right">
                                        <div class="balance">
                                            <div class="label small">Saldo</div>
                                            <div class="balance-value">{{ (data.cliente?.deuda ?? 0) |
                                                currency:'MXN':'symbol':'1.0-0' }}</div>
                                        </div>

                                        <div class="actions">
                                            <a *ngIf="(data.cliente?.deuda ?? 0) > 0" routerLink="/formas-de-pago"
                                                class="btn primary">Pagar ahora</a>
                                        </div>
                                    </div>
                                </section>
                            </div>

                        </div>
                    </div>


                    <!-- historial compacto -->
                    <section class="history">
                        <div class="card shadow-sm">
                            <div class="card-header d-flex justify-content-between align-items-center bg-white">
                                <strong>Historial de pagos </strong>
                            </div>
                            <div class="card-body p-0">
                                <div class="table-responsive">
                                    <table class="table table-hover align-middle mb-0">
                                        <thead class="table-light">
                                            <tr>
                                                <th style="width: 120px;">Venta</th>
                                                <th style="width: 140px;">Emisión</th>
                                                <th>Mensualidad</th>
                                                <th class="text-end" style="width: 160px;">Importe</th>
                                            </tr>
                                        </thead>
                                        <tbody>

                                            <tr *ngFor="let item of data?.servicios?.estadoCuenta">
                                                <td><code>{{ item?.VENTA }}</code></td>
                                                <td>{{ item?.fechaEmision }}</td>
                                                <td>{{ item?.mensualidad }}</td>
                                                <td class="text-end fw-semibold">
                                                    {{ (item?.importe || 0) | currency:'MXN':'symbol':'1.0-0' }}
                                                </td>
                                            </tr>

                                            <tr *ngIf="!data?.servicios?.estadoCuenta?.length">
                                                <td colspan="4" class="text-center text-muted py-4">Sin
                                                    movimientos</td>
                                            </tr>
                                        </tbody>

                                        <tfoot class="table-light">
                                            <tr>
                                                <th colspan="3" class="text-end">Total pendiente</th>
                                                <th class="text-end">
                                                    {{ (data?.cliente?.deuda || 0) |
                                                    currency:'MXN':'symbol':'1.0-0' }}
                                                </th>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
        </main>
    </div>
</div>